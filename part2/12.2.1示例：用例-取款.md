# 12.2.1示例：用例-取款

**前置条件：**
- 客户的银行是与自动取款机系统相连的银行。
- 客户是否有正常使用的磁条卡。
- 自动取款机已打开并处于就绪模式
- 该自动取款机位于瑞典，因此所有取款都是用瑞典克朗或瑞典克朗，可提取的钞票只有100或500张

**操作对象**
- 操作者
- ATM（网络）

**主要流程**
- H-1. 用例从客户插入卡片开始。
- H-2. ATM验证卡片并请求PIN码。
- H-3. 客户输入正确的PIN4位数字）。
- H-4. ATM会验证密码，并要求客户输入金额
- H-5. 客户键入金额(手动或使用多选择键键入1002000SEK)。货币供应量。
- H-6. 自动取款机核实客户账户上的金额，取出卡、钱和收据，并在客户账户上登记交易第
- H-7. 顾客拿了卡、钱和收据
- H-8. ATM返回待机模式
- H-9. 用例结束

**结果**
- 客户已经成功提款。使用事务Alternative Flows
- 更新客户的帐户

可选流程- A1无效卡
- a1-1. 在步骤H-1，客户插入一张无效卡。
- A1-2. ATM终止交易，卡片弹出
- A1-3. 用例结束。

可选流程-A2 PIN错误
- A2-1. 在步骤H-3中，客户输入了错误的PIN
- A2-2. ATM机注册了一个错误的密码，并要求用户再试一次。
- A2-3. 用例继续执行步骤H-3

可选流程-A3密码错误，3次
- A3-1. 在步骤H-3中，客户连续三次输入错误的PIN
- A3-2. 自动取款机将卡吞下，交易终止。
- A3-3. 用例结束。

可选流量-A4金额输入不正确
- A4-1. 在第H-5步，客户作了错误的输入(不能被100整除，账户里没有资金，超过允许提取的最大限额……)
- A4-2. 自动取款机不允许输入金额，并要求用户再试一次。
- A4-3. 用例继续执行步骤H-5

可选流量-A5客户不拿钱
- A5-1. 在H-7步骤，顾客在20秒内拿到了卡，但没有拿到钱或收据。
- A5-2. 自动取款机将收据挂在机器外面，取出钱，将其放入一个单独的容器中，并将金额、账号和瑕疵原因写入瑕疵日志中。
- A5-3. 用例继续执行步骤H-8

可选流程-A6客户的银行不是在线的(除了商业银行)
- A6-1. 在步骤H-6中，ATM无法验证客户的账户中是否存在该金额。一条消息显示与客户的银行正在建立联系，卡被弹出
- A6-2. 用例继续执行步骤H-8

可选流程-A7客户中止提款
- A7-1. 在Main flow的任何时候，除了H-6和H-7步骤外，客户都可以选择中止交易
- A7-2. 自动取款机会终止交易并弹出卡，不会提款记录在客户的账户上。
- A7-3. 用例继续执行步骤H-8